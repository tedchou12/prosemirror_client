{"code":"webpackHotUpdate(\"licit\",{\"./src/client/Licit.js\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";eval('__webpack_require__.r(__webpack_exports__);\\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/defineProperty.js\");\\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__);\\n/* harmony import */ var prosemirror_dev_tools__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prosemirror-dev-tools */ \"./node_modules/prosemirror-dev-tools/dist/esm/index.js\");\\n/* harmony import */ var prosemirror_state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! prosemirror-state */ \"./node_modules/prosemirror-state/dist/index.es.js\");\\n/* harmony import */ var prosemirror_transform__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! prosemirror-transform */ \"./node_modules/prosemirror-transform/dist/index.es.js\");\\n/* harmony import */ var prosemirror_view__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! prosemirror-view */ \"./node_modules/prosemirror-view/dist/index.es.js\");\\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__);\\n/* harmony import */ var _convertFromJSON__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../convertFromJSON */ \"./src/convertFromJSON.js\");\\n/* harmony import */ var _ui_RichTextEditor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ui/RichTextEditor */ \"./src/ui/RichTextEditor.js\");\\n/* harmony import */ var _uuid__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../uuid */ \"./src/uuid.js\");\\n/* harmony import */ var _LicitRuntime__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./LicitRuntime */ \"./src/client/LicitRuntime.js\");\\n/* harmony import */ var _SimpleConnector__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SimpleConnector */ \"./src/client/SimpleConnector.js\");\\n/* harmony import */ var _CollabConnector__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./CollabConnector */ \"./src/client/CollabConnector.js\");\\n/* harmony import */ var _createEmptyEditorState__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../createEmptyEditorState */ \"./src/createEmptyEditorState.js\");\\n/* harmony import */ var _ui_createPopUp__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../ui/createPopUp */ \"./src/ui/createPopUp.js\");\\n/* harmony import */ var _ui_PopUpPosition__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/PopUpPosition */ \"./src/ui/PopUpPosition.js\");\\n/* harmony import */ var _ui_AlertInfo__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui/AlertInfo */ \"./src/ui/AlertInfo.js\");\\n/* harmony import */ var _licit_css__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./licit.css */ \"./src/client/licit.css\");\\n/* harmony import */ var _licit_css__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(_licit_css__WEBPACK_IMPORTED_MODULE_16__);\\n/* harmony import */ var _Types__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../Types */ \"./src/Types.js\");\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n/**\\n * LICIT properties:\\n *  docID {number} [0] Collaborative Doument ID\\n *  debug {boolean} [false] To enable/disable ProseMirror Debug Tools, available only in development.\\n *  width {string} [100%] Width of the editor.\\n *  height {height} [100%] Height of the editor.\\n *  readOnly {boolean} [false] To enable/disable editing mode.\\n *  onChange {@callback} [null] Fires after each significant change.\\n *      @param data {JSON} Modified document data.\\n *  onReady {@callback} [null] Fires when the editor is fully ready.\\n *      @param ref {LICIT} Rerefence of the editor.\\n *  data {JSON} [null] Document data to be loaded into the editor.\\n *  disabled {boolean} [false] Disable the editor.\\n *  embedded {boolean} [false] Disable/Enable inline behaviour.\\n *  plugins [plugins] External Plugins into the editor.\\n */\\n\\nclass Licit extends react__WEBPACK_IMPORTED_MODULE_5__[\"Component\"] {\\n  // This will be handy in updating document\\'s content.\\n  // Flag to decide whether to skip shouldComponentUpdate\\n  constructor(_props, context) {\\n    var _this;\\n\\n    super(_props, context);\\n    _this = this;\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_runtime\", void 0);\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_connector\", void 0);\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_clientID\", void 0);\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_editorView\", void 0);\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_skipSCU\", void 0);\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_popUp\", null);\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"setContent\", function () {\\n      let content = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\\n\\n      const {\\n        doc,\\n        tr,\\n        schema\\n      } = _this._connector.getState();\\n\\n      const document = content ? schema.nodeFromJSON(content) : schema.nodeFromJSON(_createEmptyEditorState__WEBPACK_IMPORTED_MODULE_12__[\"EMPTY_DOC_JSON\"]);\\n      const selection = prosemirror_state__WEBPACK_IMPORTED_MODULE_2__[\"TextSelection\"].create(doc, 0, doc.content.size);\\n      const transaction = tr.setSelection(selection).replaceSelectionWith(document, false);\\n      _this._skipSCU = true;\\n\\n      _this._editorView.dispatch(transaction);\\n    });\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_onChange\", data => {\\n      const {\\n        transaction\\n      } = data;\\n      let isEmpty = false;\\n\\n      this._connector.onEdit(transaction);\\n\\n      if (transaction.docChanged) {\\n        const docJson = transaction.doc.toJSON();\\n\\n        if (docJson.content && docJson.content.length === 1) {\\n          if (docJson.content[0].content && \\'\\' === docJson.content[0].content[0].text.trim()) {\\n            isEmpty = true;\\n          }\\n        }\\n\\n        this.state.onChangeCB(docJson, isEmpty);\\n      }\\n    });\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_onReady\", editorView => {\\n      // [FS][06-APR-2020][IRAD-922]\\n      // Showing focus in the editor.\\n      const {\\n        state,\\n        dispatch\\n      } = editorView;\\n      this._editorView = editorView;\\n      const tr = state.tr;\\n      const doc = state.doc;\\n      dispatch(tr.setSelection(prosemirror_state__WEBPACK_IMPORTED_MODULE_2__[\"TextSelection\"].create(doc, 0, doc.content.size)));\\n      editorView.focus();\\n\\n      if (this.state.onReadyCB) {\\n        this.state.onReadyCB(this);\\n      }\\n\\n      if (this.state.debug) {\\n        window.debugProseMirror = () => {\\n          Object(prosemirror_dev_tools__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(editorView);\\n        };\\n\\n        window.debugProseMirror();\\n      }\\n    });\\n\\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"setProps\", props => {\\n      if (this.state.readOnly) {\\n        // It should be possible to load content into the editor in readonly as well.\\n        // It should not be necessary to make the component writable any time during the process\\n        let propsCopy = {};\\n        this._skipSCU = true;\\n        Object.assign(propsCopy, props); // make writable without content change\\n\\n        propsCopy.readOnly = false;\\n        delete propsCopy.data;\\n        this.setState(propsCopy);\\n      } // Need to go through shouldComponentUpdate lifecycle here, when updated from outside,\\n      // so that content is modified gracefully using transaction so that undo/redo works too.\\n\\n\\n      this._skipSCU = false;\\n      this.setState(props);\\n    });\\n\\n    this._clientID = Object(_uuid__WEBPACK_IMPORTED_MODULE_8__[\"default\"])();\\n    this._editorView = null;\\n    this._skipSCU = true;\\n\\n    const noop = function () {}; // [FS] IRAD-981 2020-06-10\\n    // Component\\'s configurations.\\n\\n\\n    const docID = _props.docID || 0; // 0 < means collaborative.\\n\\n    const collaborative = 0 < docID;\\n    const debug = _props.debug || false; // Default width and height to undefined\\n\\n    const width = _props.width || undefined;\\n    const height = _props.height || undefined;\\n    const onChangeCB = typeof _props.onChange === \\'function\\' ? _props.onChange : noop;\\n    const onReadyCB = typeof _props.onReady === \\'function\\' ? _props.onReady : noop;\\n    const readOnly = _props.readOnly || false;\\n\\n    const _data = _props.data || null;\\n\\n    const disabled = _props.disabled || false;\\n    const embedded = _props.embedded || false; // [FS] IRAD-996 2020-06-30\\n    // [FS] 2020-07-03\\n    // Handle Image Upload from Angular App\\n\\n    const runtime = _props.runtime ? _props.runtime : new _LicitRuntime__WEBPACK_IMPORTED_MODULE_9__[\"default\"]();\\n    const plugins = _props.plugins || null;\\n    let editorState = Object(_convertFromJSON__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(_data, null, plugins); // [FS] IRAD-1067 2020-09-19\\n    // The editorState will return null if the doc Json is mal-formed\\n\\n    if (null === editorState) {\\n      editorState = Object(_convertFromJSON__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(_createEmptyEditorState__WEBPACK_IMPORTED_MODULE_12__[\"EMPTY_DOC_JSON\"], null, plugins);\\n      this.showAlert();\\n    }\\n\\n    const setState = this.setState.bind(this);\\n    this._connector = collaborative ? new _CollabConnector__WEBPACK_IMPORTED_MODULE_11__[\"default\"](editorState, setState, {\\n      docID\\n    }) : new _SimpleConnector__WEBPACK_IMPORTED_MODULE_10__[\"default\"](editorState, setState); // FS IRAD-989 2020-18-06\\n    // updating properties should automatically render the changes\\n\\n    this.state = {\\n      docID,\\n      data: _data,\\n      editorState,\\n      width,\\n      height,\\n      readOnly,\\n      onChangeCB,\\n      onReadyCB,\\n      debug,\\n      disabled,\\n      embedded,\\n      runtime\\n    }; // FS IRAD-1040 2020-26-08\\n    // Get the modified schema from editorstate and send it to collab server\\n\\n    if (this._connector.updateSchema) {\\n      this._connector.updateSchema(this.state.editorState.schema);\\n    }\\n  } // [FS] IRAD-1067 2020-09-19\\n  // Alert funtion to show document is corrupted\\n\\n\\n  showAlert() {\\n    const anchor = null;\\n    this._popUp = Object(_ui_createPopUp__WEBPACK_IMPORTED_MODULE_13__[\"default\"])(_ui_AlertInfo__WEBPACK_IMPORTED_MODULE_15__[\"default\"], null, {\\n      anchor,\\n      position: _ui_PopUpPosition__WEBPACK_IMPORTED_MODULE_14__[\"atViewportCenter\"],\\n      onClose: val => {\\n        if (this._popUp) {\\n          this._popUp = null;\\n        }\\n      }\\n    });\\n  }\\n\\n  shouldComponentUpdate(nextProps, nextState) {\\n    // Only interested if properties are set from outside.\\n    if (!this._skipSCU) {\\n      this._skipSCU = false;\\n      let dataChanged = false; // Compare data, if found difference, update editorState\\n\\n      if (this.state.data !== nextState.data) {\\n        dataChanged = true;\\n      } else if (null === nextState.data) {\\n        if (this.state.editorState.doc.textContent && 0 < this.state.editorState.doc.textContent.trim().length) {\\n          dataChanged = true;\\n        }\\n      }\\n\\n      if (dataChanged) {\\n        // data changed, so update document content\\n        this.setContent(nextState.data);\\n      }\\n\\n      if (this.state.docID !== nextState.docID) {\\n        // Collaborative mode changed\\n        const collabEditing = nextState.docID != 0;\\n\\n        const editorState = this._connector.getState();\\n\\n        const setState = this.setState.bind(this);\\n        const docID = nextState.docID || 1; // create new connector\\n\\n        this._connector = collabEditing ? new _CollabConnector__WEBPACK_IMPORTED_MODULE_11__[\"default\"](editorState, setState, {\\n          docID\\n        }) : new _SimpleConnector__WEBPACK_IMPORTED_MODULE_10__[\"default\"](editorState, setState);\\n      }\\n    }\\n\\n    return true;\\n  }\\n\\n  render() {\\n    const {\\n      editorState,\\n      width,\\n      height,\\n      readOnly,\\n      disabled,\\n      embedded,\\n      runtime\\n    } = this.state; // [FS] IRAD-978 2020-06-05\\n    // Using 100vw & 100vh (100% viewport) is not ideal for a component which is expected to be a part of a page,\\n    // so changing it to 100%  width & height which will occupy the area relative to its parent.\\n\\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_5__[\"createElement\"](_ui_RichTextEditor__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\\n      editorState: editorState,\\n      embedded: embedded,\\n      height: height,\\n      onChange: this._onChange,\\n      onReady: this._onReady,\\n      readOnly: readOnly,\\n      runtime: runtime,\\n      width: width,\\n      disabled: disabled\\n    });\\n  }\\n\\n}\\n\\n/* harmony default export */ __webpack_exports__[\"default\"] = (Licit);\\n\\n\\n//# sourceURL=webpack:///./src/client/Licit.js?')}});","extractedComments":["/*!*****************************!*\\\n  !*** ./src/client/Licit.js ***!\n  \\*****************************/","/*! exports provided: default */"]}